{% extends "base.html" %}
{% block content %}
<div class="container mt-4">

  <h4 class="mb-3">Unidades de Negocio – SEF</h4>

  <!-- LISTADO EXISTENTE -->
  {% if solicitud.sef_unidades %}
  <div class="card mb-4">
    <div class="card-body p-2">
      <table class="table table-sm table-bordered mb-0">
        <thead class="table-light">
          <tr>
            <th>#</th>
            <th>Nombre</th>
            <th>CPAE</th>
            <th>ETV</th>
            <th>Acción</th>
          </tr>
        </thead>
        <tbody>
          {% for u in solicitud.sef_unidades %}
          <tr>
            <td>{{ loop.index }}</td>
            <td>{{ u.nombre_unidad }}</td>
            <td>{{ u.cpae_unidad }}</td>
            <td>{{ u.etv_unidad }}</td>
            <td>{{ u.accion_unidad }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% endif %}

  <!-- FORMULARIO NUEVA UNIDAD -->
  <form method="POST">

    <div class="card shadow-sm mb-3">
      <div class="card-body">

        <div class="row g-3">

          <div class="col-md-4">
            <label class="form-label">Acción</label>
            <select name="accion_unidad" class="form-select">
              <option value="ALTA">ALTA</option>
              <option value="MODIFICACION">MODIFICACIÓN</option>
              <option value="BAJA">BAJA</option>
            </select>
          </div>

          <div class="col-md-8">
            <label class="form-label">Nombre Unidad</label>
            <input type="text" name="nombre_unidad" class="form-control">
          </div>

          <div class="col-md-4">
            <label class="form-label">CPAE</label>
            <input type="text" name="cpae_unidad" class="form-control">
          </div>

          <div class="col-md-4">
            <label class="form-label">ETV</label>
            <input type="text" name="etv_unidad" class="form-control">
          </div>

          <div class="col-md-4">
            <label class="form-label">Procesadora</label>
            <input type="text" name="procesadora_unidad" class="form-control">
          </div>

        </div>

        <hr class="my-4">

        <h6>Servicios</h6>

        <div class="row g-2">

          <div class="col-md-4 form-check">
            <input class="form-check-input" type="checkbox" name="servicio_verificacion_tradicional">
            <label class="form-check-label">Depósito Tradicional</label>
          </div>

          <div class="col-md-4 form-check">
            <input class="form-check-input" type="checkbox" name="servicio_verificacion_electronica">
            <label class="form-check-label">Depósito Electrónico</label>
          </div>

          <div class="col-md-4 form-check">
            <input class="form-check-input" type="checkbox" name="servicio_cliente_certificado_central">
            <label class="form-check-label">Cliente Certificado Central</label>
          </div>

          <div class="col-md-4 form-check">
            <input class="form-check-input" type="checkbox" name="servicio_dotacion_centralizada">
            <label class="form-check-label">Dotación Centralizada</label>
          </div>

          <div class="col-md-4 form-check">
            <input class="form-check-input" type="checkbox" name="servicio_integradora">
            <label class="form-check-label">Unidad Integradora</label>
          </div>

          <div class="col-md-4 form-check">
            <input class="form-check-input" type="checkbox" name="servicio_dotacion">
            <label class="form-check-label">Dotación Electrónica</label>
          </div>

          <div class="col-md-4 form-check">
            <input class="form-check-input" type="checkbox" name="servicio_traslado">
            <label class="form-check-label">Traslado de Valores</label>
          </div>

          <div class="col-md-4 form-check">
            <input class="form-check-input" type="checkbox" name="servicio_cofre">
            <label class="form-check-label">Renta de Cofre</label>
          </div>

        </div>

        <hr class="my-4">

        <h6>Domicilio</h6>

        <div class="row g-3">

          <div class="col-md-6">
            <label class="form-label">Calle y Número</label>
            <input type="text" name="calle_numero" class="form-control">
          </div>

          <div class="col-md-3">
            <label class="form-label">Municipio (ID)</label>
            <input type="number" name="municipio" class="form-control">
          </div>

          <div class="col-md-3">
            <label class="form-label">Entidad Federativa (ID)</label>
            <input type="number" name="entidad_federativa" class="form-control">
          </div>

          <div class="col-md-3">
            <label class="form-label">Código Postal</label>
            <input type="number" name="codigo_postal" class="form-control">
          </div>

        </div>

      </div>
    </div>

    <div class="d-flex justify-content-between">
      <a href="{{ url_for('solicitudes_flow.step', solicitud_id=solicitud.id, step=2) }}"
         class="btn btn-outline-secondary btn-sm">
        ← Regresar
      </a>

      <div>
        <button type="submit" class="btn btn-primary btn-sm">
          Guardar Unidad
        </button>

        <a href="{{ url_for('solicitudes_flow.step', solicitud_id=solicitud.id, step=4) }}"
           class="btn btn-success btn-sm">
          Siguiente →
        </a>
      </div>
    </div>

  </form>

</div>
{% endblock %}
