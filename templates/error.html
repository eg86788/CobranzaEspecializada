{% extends "base.html" %}
{% block title %}¡Ups! Ocurrió un error{% endblock %}

{% block content %}
<style>
  .error-hero {
    max-width: 720px; margin: 0 auto; text-align: center;
  }
  .error-illust {
    width: 220px; height: 220px; margin: 0 auto 1rem auto; display:block;
  }
</style>

<div class="error-hero">
  <!-- Ilustración simpática (SVG inline) -->
  <svg class="error-illust" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
    <circle cx="100" cy="100" r="95" fill="#DAE9EE"/>
    <g transform="translate(55,60)">
      <rect x="0" y="0" width="90" height="55" rx="8" fill="#003746"/>
      <rect x="8" y="8" width="74" height="12" rx="6" fill="#ffffff" opacity=".9"/>
      <rect x="8" y="26" width="36" height="8" rx="4" fill="#ffffff" opacity=".85"/>
      <rect x="50" y="26" width="32" height="8" rx="4" fill="#ffffff" opacity=".85"/>
      <rect x="28" y="40" width="34" height="8" rx="4" fill="#FF1B44" opacity=".95"/>
    </g>
    <g transform="translate(66,125)">
      <ellipse cx="34" cy="12" rx="34" ry="8" fill="#b8cdd3"/>
    </g>
  </svg>

  <h1 class="h4 mb-2">Algo se cayó…</h1>
  <p class="text-muted mb-3">
    {% if error_code %}Código <strong>{{ error_code }}</strong>.{% endif %}
    {% if error_id %} ID: <strong>{{ error_id }}</strong>.{% endif %}
  </p>

  {% if error_message %}
    <p class="mb-3">{{ error_message }}</p>
  {% else %}
    <p class="mb-3">Hubo un problema procesando tu solicitud. Tu sesión sigue activa.</p>
  {% endif %}

  <div class="d-flex flex-wrap gap-2 justify-content-center">
    <a href="{{ url_for('core.inicio_productos') }}" class="btn btn-outline-secondary">
      <i class="bi bi-house-door me-1"></i> Ir al inicio
    </a>
    <a href="mailto:edgar.garciablanca@banamex.com?subject=Error%20{{ error_code }}%20ID%20{{ error_id }}" class="btn btn-outline-primary">
      <i class="bi bi-bug me-1"></i> Reportar
    </a>
    {% if current_role %}
      <a class="btn btn-outline-danger" href="{{ url_for('auth_admin.logout') }}">
        <i class="bi bi-box-arrow-right me-1"></i> Salir
      </a>
    {% endif %}
  </div>
</div>

<script>
    // Mantiene viva la sesión mientras esté abierta la página
    setInterval(() => {
      fetch("{{ url_for('auth_admin.ping') }}", { cache: "no-store" }).catch(()=>{});
    }, 5 * 60 * 1000);
  </script>
  

{% endblock %}
